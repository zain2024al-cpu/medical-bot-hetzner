# ุฅุตูุงุญ ูุดููุฉ ุนุฏู ุญูุธ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ุงููุดููุฉ

ูุงูุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ุชุญูุธ ุงูุจูุงูุงุช ุจุดูู ุฏุงุฆู. ุนูู ุณุจูู ุงููุซุงูุ ุนูุฏ ุฅุถุงูุฉ ูุณุชุดูู ุฌุฏูุฏ ูู ุงูุฃุฏููุ ูุฎุชูู ูู ุงูููู ุงูุชุงูู ููุญุชุงุฌ ูุฅุถุงูุชู ูุฑุฉ ุฃุฎุฑู.

## ๐ง ุงูุณุจุจ

ุงููุดููุฉ ูุงูุช ูู ุงุณุชุฎุฏุงู `SessionLocal()` ุจุดูู ุฎุงุทุฆ:

```python
# โ ุฎุทุฃ - SessionLocal() ููุณ context manager
with SessionLocal() as s:
    s.add(new_hospital)
    s.commit()  # ูุฏ ูุง ูุชู ุงูู commit ุจุดูู ุตุญูุญ
```

`SessionLocal()` ูู `sessionmaker` ูููุณ context managerุ ูุฐูู ุงุณุชุฎุฏุงูู ูุน `with` statement ูุฏ ูุง ูุนูู ุจุดูู ุตุญูุญ ููุฏ ูุง ูุชู ุงูู commit ุจุดูู ุฏุงุฆู.

## โ ุงูุญู

ุชู ุงุณุชุจุฏุงู ุฌููุน ุงุณุชุฎุฏุงูุงุช `SessionLocal()` ุจู `get_db()` context manager ุงูุฐู ูุถูู:
- โ ุงูู commit ุงูุชููุงุฆู ุนูุฏ ุงูุฎุฑูุฌ ุจูุฌุงุญ
- โ ุงูู rollback ุงูุชููุงุฆู ุนูุฏ ุญุฏูุซ ุฎุทุฃ
- โ ุฅุบูุงู ุงูู session ุชููุงุฆูุงู

```python
# โ ุตุญูุญ - get_db() ูู context manager
from db.session import get_db

with get_db() as s:
    s.add(new_hospital)
    # get_db() ูููู ุจุงูู commit ุชููุงุฆูุงู ุนูุฏ ุงูุฎุฑูุฌ
```

## ๐ ุงูุชุบููุฑุงุช

ุชู ุฅุตูุงุญ ุงูููู ุงูุชุงูู:
- `bot/handlers/admin/admin_hospitals_management.py`

ุฌููุน ุงูุฏูุงู ุงูุชุงููุฉ ุชู ุฅุตูุงุญูุง:
- โ `handle_manage_hospitals()` - ุนุฑุถ ุงููุณุชุดููุงุช
- โ `handle_view_hospitals()` - ุนุฑุถ ูุงุฆูุฉ ุงููุณุชุดููุงุช
- โ `handle_hospital_name_input()` - ุฅุถุงูุฉ ูุณุชุดูู ุฌุฏูุฏ
- โ `handle_delete_hospital()` - ุนุฑุถ ูุงุฆูุฉ ุงูุญุฐู
- โ `handle_edit_hospital()` - ุนุฑุถ ูุงุฆูุฉ ุงูุชุนุฏูู
- โ `handle_edit_hospital_input()` - ุชุนุฏูู ุงุณู ูุณุชุดูู
- โ `handle_sync_hospitals()` - ูุฒุงููุฉ ุงููุณุชุดููุงุช

## ๐งช ุงูุงุฎุชุจุงุฑ

ุชู ุฅูุดุงุก ููู ุงุฎุชุจุงุฑ `test_hospital_save.py` ููุชุญูู ูู ุฃู ุงูุญูุธ ูุนูู ุจุดูู ุตุญูุญ:

```bash
python test_hospital_save.py
```

ุงููุชูุฌุฉ: โ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ูุฌุญุช!

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงุณุชุฎุฏุงู get_db() ุฏุงุฆูุงู**: ุนูุฏ ุงูุชุนุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุงุณุชุฎุฏู `get_db()` context manager ุจุฏูุงู ูู `SessionLocal()` ูุจุงุดุฑุฉ.

2. **ูุง ุญุงุฌุฉ ูู commit ูุฏูู**: `get_db()` ูููู ุจุงูู commit ุชููุงุฆูุงู ุนูุฏ ุงูุฎุฑูุฌ ุจูุฌุงุญ ูู ุงูู `with` block.

3. **ุงูู rollback ุงูุชููุงุฆู**: ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃุ `get_db()` ูููู ุจุงูู rollback ุชููุงุฆูุงู.

## ๐ ุงููุดุฑ

ุจุนุฏ ุฅุตูุงุญ ุงููุดููุฉุ ูุฌุจ ูุดุฑ ุงูุชุบููุฑุงุช ุนูู ุงูุณูุฑูุฑ:

```bash
# ุนูู Windows
deploy_all_to_hetzner.bat

# ุฃู ุนูู Linux/Mac
./deploy-to-hetzner.sh
```

## โ ุงูุชุญูู ูู ุงูุฅุตูุงุญ

ุจุนุฏ ุงููุดุฑุ ูููู ุงูุชุญูู ูู ุฃู ุงูุญูุธ ูุนูู ุจุดูู ุตุญูุญ:

1. ุฃุถู ูุณุชุดูู ุฌุฏูุฏ ูู ุงูุฃุฏูู
2. ุฃุนุฏ ุชุดุบูู ุงูุจูุช
3. ุชุญูู ูู ุฃู ุงููุณุชุดูู ูุง ูุฒุงู ููุฌูุฏุงู

ุฅุฐุง ูุงูุช ุงููุดููุฉ ูุณุชูุฑุฉุ ูุฏ ุชููู ููุงู ูุดููุฉ ูู:
- ูุณุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนูู ุงูุณูุฑูุฑ
- ุตูุงุญูุงุช ุงููุชุงุจุฉ ุนูู ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููุงู ูุคูุช (ูุซู `/tmp`)

## ๐ ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ุชุญูู ูู:
1. ูุณุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนูู ุงูุณูุฑูุฑ: `DATABASE_PATH` ูู `config.env`
2. ุตูุงุญูุงุช ุงูููู: ูุฌุจ ุฃู ูููู ููุจูุช ุตูุงุญูุงุช ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ
3. ูููุน ุงูููู: ูุฌุจ ุฃู ูููู ูู ููุงู ุฏุงุฆู ูููุณ ูุคูุช
